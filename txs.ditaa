@startuml
ditaa(--no-separation)

+--------------------------------------+     +----------------------------+
| Funding Tx ("f")                     |     | Balance Tx ("n")           |
+----------------+---------------------+     +------------+---------------+
| ...            | ...                 |  +->+ funding    | Alice balance +-+
+----------------+---------------------+  |  |            +---------------+ |
| ...            | funding output      +--+  |            | Bob balance   | |
+----------------+---------------------+     +------------+---------------+ |
| ...            | ...                 |                                    |
+----------------+---------------------+                                    |
                                                                            |
+---------------------------------------------------------------------------+
|
|  +-----------------------------------------+
|  | Inflight tx from Alice to Bob ("i")     |
|  +---------------+-------------------------+
+->| Alice balance | Alice remaining         |
   |               +-------------------------+
   |               | Bob completed           |
   |               +-------------------------+
   |               | HTLC 0                  +---+
   |               +-------------------------+   |
   |               | PTLC 1                  +-+ |
   +---------------+-------------------------+ | |
                                               | |
+----------------------------------------------+ |
| +----------------------------------------------+
| |
| |  +------------------------------------------+
| |  | Layered transaction                      |
| |  +------------+-----------------------------+
| +->+ HTLC 0     | revocable payment to Bob    |
|    +------------+-----------------------------+
+--->+ PTLC 1     | revocable payment to Bob    |
     +------------+-----------------------------+
     | misc funds | change from misc after fees |
     +------------+-----------------------------+

@enduml
